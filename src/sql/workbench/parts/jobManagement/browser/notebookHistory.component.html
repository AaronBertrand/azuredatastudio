<!--
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the Source EULA. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
-->
<div class="jobhistory-heading-container">
	<h1 class="job-heading">Notebook | {{ this._agentJobInfo?.name }}</h1>
	<div class="icon in-progress" *ngIf="showProgressWheel()"></div>
</div>

<!-- Back -->
<div
	class="all-jobs"
	tabindex="0"
	(click)="goToJobs()"
	(keyup.enter)="goToJobs()"
>
	<div
		class="back-button-icon"
		(click)="goToJobs()"
		(keyup.enter)="goToJobs()"
	></div>
	All Notebooks
</div>

<!-- Actions -->
<div #actionbarContainer class="agent-actionbar-container"></div>

<!-- Overview  -->
<div class="overview-container">
	<div class="overview-tab" (click)="toggleCollapse()" tabindex="0">
		<input id="accordion" type="checkbox" />
		<label for="accordion">
			<div
				class="resultsViewCollapsible collapsed"
				(click)="toggleCollapse()"
			></div>
			Overview
		</label>
		<div class="accordion-content">
			<table align="left">
				<tr>
					<td id="col1">
						TargetDatabase:
					</td>
					<td id="col2">
						{{ this._agentNotebookInfo?.targetDatabase }}
					</td>
					<td id="col3">
						Enabled:
					</td>
					<td id="col4">
						{{ this._agentJobInfo?.enabled }}
					</td>
				</tr>
				<tr>
					<td id="col1">
						Template Notebook:
					</td>
					<td id="col2">
						{{ this._agentJobInfo?.hasTarget }}
					</td>
					<td id="col3">
						Has Schedule:
					</td>
					<td id="col4">
						{{ this._agentJobInfo?.hasSchedule }}
					</td>
				</tr>
				<tr>
					<td id="col1">
						Last Run:
					</td>
					<td id="col2">
						{{ this._agentJobInfo?.lastRun }}
					</td>
					<td id="col3">
						Next Run:
					</td>
					<td id="col4">
						{{ this._agentJobInfo?.nextRun }}
					</td>
				</tr>
			</table>
		</div>
	</div>
</div>
<!-- Overview  -->
<div class="notebook-history-container">
	<div class="notebook-grid-container">
		<div
			class="container"
			*ngIf="notebookHistories | historyFilter: 0:604800:1 as currentHistory"
		>
			<div class="grid-title"><span>This Week</span></div>
			<div class="notebook-grid">
				<div
					*ngFor="let history of currentHistory"
					class="notebook-grid-item"
					(click)="openNotebook(history)"
				>
					<div *ngIf="history.runStatus === 1" class="img-success"></div>
					<div *ngIf="history.runStatus === 0" class="img-failure"></div>
					<p>
						{{ formatDateTimetoLocaleDate(history.runDate) }}
						<br />
						{{ formatDateTimetoLocaleTime(history.runDate) }}
					</p>
				</div>
			</div>
		</div>
		<div
			class="container"
			*ngIf="
				notebookHistories | historyFilter: 604801:1209600:1 as currentHistory
			"
		>
			<div class="grid-title"><span>Last Week</span></div>
			<div class="notebook-grid">
				<div
					*ngFor="let history of currentHistory"
					class="notebook-grid-item"
					(click)="openNotebook(history)"
				>
					<div *ngIf="history.runStatus === 1" class="img-success"></div>
					<div *ngIf="history.runStatus === 0" class="img-failure"></div>
					<p>
							{{ formatDateTimetoLocaleDate(history.runDate) }}
							<br />
							{{ formatDateTimetoLocaleTime(history.runDate) }}
					</p>
				</div>
			</div>
		</div>
		<div
			class="container"
			*ngIf="
				notebookHistories | historyFilter: 1209601:2592000:0 as currentHistory
			"
		>
			<div class="grid-title"><span>Last Month</span></div>
			<div class="notebook-grid">
				<div
					*ngFor="let history of currentHistory"
					class="notebook-grid-item"
					(click)="openNotebook(history)"
				>
					<div *ngIf="history.runStatus === 1" class="img-success"></div>
					<div *ngIf="history.runStatus === 0" class="img-failure"></div>
					<p>
							{{ formatDateTimetoLocaleDate(history.runDate) }}
							<br />
							{{ formatDateTimetoLocaleTime(history.runDate) }}
					</p>
				</div>
			</div>
		</div>
		<div
			class="container"
			*ngIf="
				notebookHistories | historyFilter: 2592001:31557600:0 as currentHistory
			"
		>
			<div class="grid-title"><span>All Past Runs</span></div>
			<div class="notebook-grid">
				<div
					*ngFor="let history of currentHistory"
					class="notebook-grid-item"
					(click)="openNotebook(history)"
				>
					<div *ngIf="history.runStatus === 1" class="img-success"></div>
					<div *ngIf="history.runStatus === 0" class="img-failure"></div>
					<p>
							{{ formatDateTimetoLocaleDate(history.runDate) }}
							<br />
							{{ formatDateTimetoLocaleTime(history.runDate) }}
					</p>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Job History details -->
<div class="history-details">
	<!-- Previous run list -->
	<div class="prev-run-list-container" style="min-width: 270px">
		<h3 *ngIf="_showPreviousRuns === false" style="text-align: center">
			No Previous Runs Available
		</h3>
		<div
			class="step-table prev-run-list"
			style="position: relative; width: 100%"
		>
			<div #table style="position: absolute; width: 100%; height: 100%"></div>
		</div>
	</div>
</div>
